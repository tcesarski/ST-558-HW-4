[
  {
    "objectID": "ST 558 HW 4.html",
    "href": "ST 558 HW 4.html",
    "title": "ST 558 Homework 4",
    "section": "",
    "text": "Task 1\n\nQuestion #1: What is the purpose of the lapply() function? What is the equivalent purrr function?\nThe lapply() function applies a function to each element of a list. The equivalent using purrr function would be map().\n\n\nQuestion #2: Suppose we have a list called my_list. Each element of the list is a numeric data frame. We want to use lapply() to run the code cor(numeric_matrix, method = “kendall”) on each element of the list. Write code to do this below.\nlapply(X = my_list, FUN = cor, method = \"kendall\")\nThis code takes in the my_list, applies the cor function and gives additional arguments (in this case the method) afterwards.\n\n\nQuestion #3: What are two advantages of using purrr functions instead of the base R apply family?\nTwo advantages of using purrr is more consistency (the first argument is always the data in map functions) and some additional helper functions such as walk().\n\n\nQuestion #4: What is a side effect function?\nA side-effect function is a function that doesn’t generally try to change the data, but rather produces something. Examples of side effect functions include print(), write_csv(), and plot(). Side effect functions also don’t naturally return the modified argument so you would need to use invisible() to do that.\n\n\nQuestion #5: Why can you name a variable sd in a function and not cause any issues with the sd function?\nWhen you create a new function, you are essentially creating a new temporary function environment. This means that R will first look within the function environment/current environment before searching up the path. It will only continue searching up the path if it doesn’t already find the sd within the function, meaning there will be no conflicts.\n\n\n\nTask 2\n\nQuestion #1: Write a basic function called getRMSE() that takes in a vector of responses and a vector of predictions and outputs the RMSE.\n\nlibrary(tidyverse)\n#Create getRMSE() function. Add elipses to pass to mean function to remove missing values. Arguments to input are two numeric vectors (response and prediction).\ngetRMSE &lt;- function(vector_resp, vector_pred,...){\n  #Calculate the differences (response-prediction)\n  diff &lt;- vector_resp - vector_pred\n  \n  #Square the difference\n  diff_squared &lt;- (diff)^2\n  \n  #Then add them all up (sum) and divide by the total number of observations (n). This is equivalent to finding the mean. \n  #Add elipses to add additional argument for removing missing values.\n  mean_diff &lt;- mean(diff_squared,...)\n  \n  #Take the square root.\n  RMSE &lt;- sqrt(mean_diff)\n  \n  #Return the RMSE (root mean squared error).\n  return(RMSE)\n}\n\n\n\nQuestion #2: Run the following code to create some response values and predictions. Test the function using this data.\n\nset.seed(10)\nn &lt;- 100\nx &lt;- runif(n)\n#Create response and prediction vectors.\nresp &lt;- 3 + 10*x + rnorm(n)\npred &lt;- predict(lm(resp ~ x), data.frame(x))\n\n#Test RMSE function using this data. Use resp & pred as input vectors. \ngetRMSE(resp, pred)\n\n[1] 0.9581677\n\n#Replace the first two values with NA_real.\nresp[1:2] &lt;- NA_real_\n#Print out new resp vector to show that first two values are now missing.\nresp\n\n  [1]        NA        NA  8.637031 12.068788  4.357179  6.040709  4.843093\n  [8]  6.255948  8.512399  7.587703  8.278962  8.221201  3.304767  9.299369\n [15]  7.646876  8.504220  4.254724  5.160568  7.550652 10.115022 12.028134\n [22]  7.723097  9.702653  6.337183  5.568563 11.239175  9.903050  4.965503\n [29]  9.656077  8.081564  8.948798  3.708220  5.410925 12.714925  7.666618\n [36] 10.636295 11.886290 14.767056  8.670500  7.931076  5.338484  5.097557\n [43]  3.213884 11.444994  6.093762  3.192188  1.563749  8.753929  4.177170\n [50] 12.242498  5.781476 12.783701  4.418721  8.442989  4.282396  9.395394\n [57]  8.255719  6.016290  8.026494  9.180810  2.038727  5.273544  7.225220\n [64]  6.654107 12.260485 10.688362  9.773488  8.216967  5.093565  6.142304\n [71]  3.274337  8.547150  9.381826  7.061813  4.016495  7.543794  6.976389\n [78] 11.550401  5.209433  3.872522 13.043037  8.277356  3.231859  8.553664\n [85]  4.576422  2.213665 11.475262  6.469006  5.333390  5.656304  6.209727\n [92]  8.908905  6.956097  9.642321  7.188749 12.413663  6.020730  8.507994\n [99] 11.776177  3.387353\n\n#Test function with specifying missing values.\ngetRMSE(resp, pred, na.rm = TRUE)\n\n[1] 0.9661699\n\n#Test function without specifying missing values.\ngetRMSE(resp, pred)\n\n[1] NA\n\n\n\n\nQuestion #3: Write a function called getMAE() that follows the specifications of the getRMSE() function.\n\ngetMAE &lt;- function(vector_resp, vector_pred,...){\n  #Calculate the differences (response-prediction)\n  diff &lt;- vector_resp - vector_pred\n  \n  #Find the absolute value of the difference.\n  abs_diff &lt;- abs(diff)\n  \n  #Then add them all up (sum) and divide by the total number of observations (n). This is equivalent to finding the mean.\n  MAE &lt;- mean(abs_diff,...)\n  \n  return(MAE)\n}\n\n\n\nQuestion #4: Run the following code to create some response values and predictions.\n\nset.seed(10)\nn &lt;- 100\nx &lt;- runif(n)\nresp &lt;- 3 + 10*x +rnorm(n)\npred &lt;- predict(lm(resp~x), data.frame(x))\n\n#Test MAE function using this data.\ngetMAE(resp, pred)\n\n[1] 0.8155776\n\n#Replace the first two values with NA_real.\nresp[1:2] &lt;- NA_real_\n#Print out new resp vector to show that first two values are now missing.\nresp\n\n  [1]        NA        NA  8.637031 12.068788  4.357179  6.040709  4.843093\n  [8]  6.255948  8.512399  7.587703  8.278962  8.221201  3.304767  9.299369\n [15]  7.646876  8.504220  4.254724  5.160568  7.550652 10.115022 12.028134\n [22]  7.723097  9.702653  6.337183  5.568563 11.239175  9.903050  4.965503\n [29]  9.656077  8.081564  8.948798  3.708220  5.410925 12.714925  7.666618\n [36] 10.636295 11.886290 14.767056  8.670500  7.931076  5.338484  5.097557\n [43]  3.213884 11.444994  6.093762  3.192188  1.563749  8.753929  4.177170\n [50] 12.242498  5.781476 12.783701  4.418721  8.442989  4.282396  9.395394\n [57]  8.255719  6.016290  8.026494  9.180810  2.038727  5.273544  7.225220\n [64]  6.654107 12.260485 10.688362  9.773488  8.216967  5.093565  6.142304\n [71]  3.274337  8.547150  9.381826  7.061813  4.016495  7.543794  6.976389\n [78] 11.550401  5.209433  3.872522 13.043037  8.277356  3.231859  8.553664\n [85]  4.576422  2.213665 11.475262  6.469006  5.333390  5.656304  6.209727\n [92]  8.908905  6.956097  9.642321  7.188749 12.413663  6.020730  8.507994\n [99] 11.776177  3.387353\n\n#Test function with specifying missing values.\ngetMAE(resp, pred, na.rm = TRUE)\n\n[1] 0.8241201\n\n#Test function without specifying missing values.\ngetMAE(resp, pred)\n\n[1] NA\n\n\n\n\nQuestion #5: Create a wrapper function that can be used to get either or both metrics returned with a single function call.\n\nlibrary(tidyverse)\nwrap_all &lt;- function(response, prediction, values = \"both\", ...){\n  #If either input is not a numeric vector, print a message and stop the function.\n  if(!is.numeric(response) | !is.numeric(prediction) | !is.vector(response) | !is.vector(prediction)){\n    print(\"Response or prediction vectors are not numeric.\")\n    #If values is both, run both functions and return a named list.\n  } else if (values == \"both\"){\n    return(list(RMSE = getRMSE(response, prediction,...), MAE = getMAE(response, prediction,...)))\n    #If values is just RMSE run the getRMSE function and return a named list.\n  } else if (values == \"RMSE\"){\n    return(list(RMSE = getRMSE(response, prediction,...)))\n    #If values is just MAE run the getMAE function and return a named list.\n  } else if (values == \"MAE\"){\n    return(list(MAE = getMAE(response, prediction,...)))\n    #If none of the above options are given, print error message.\n  } else {\n    print(\"Invalid input for values. Need both, MAE, or RMSE.\")\n  }\n}\n\n\n\nQuestion #6: Run the following code to create some response values and predictions.\n\nset.seed(10)\nn &lt;- 100\nx &lt;- runif(n)\nresp &lt;- 3 + 10*x +rnorm(n)\npred &lt;- predict(lm(resp~x), data.frame(x))\n\n#Test the function with just getting the RMSE.\nwrap_all(resp, pred, \"RMSE\")\n\n$RMSE\n[1] 0.9581677\n\n#Test the function with just getting the MAE.\nwrap_all(resp, pred, \"MAE\")\n\n$MAE\n[1] 0.8155776\n\n#Test the function with getting both. Specify both with defaults and with explicitly calling values = both.\n\nwrap_all(resp, pred, values = \"both\")\n\n$RMSE\n[1] 0.9581677\n\n$MAE\n[1] 0.8155776\n\nwrap_all(resp, pred)\n\n$RMSE\n[1] 0.9581677\n\n$MAE\n[1] 0.8155776\n\n#Replace the first two values with NA_real.\nresp[1:2] &lt;- NA_real_\n#Print out new resp vector to show that first two values are now missing.\nresp\n\n  [1]        NA        NA  8.637031 12.068788  4.357179  6.040709  4.843093\n  [8]  6.255948  8.512399  7.587703  8.278962  8.221201  3.304767  9.299369\n [15]  7.646876  8.504220  4.254724  5.160568  7.550652 10.115022 12.028134\n [22]  7.723097  9.702653  6.337183  5.568563 11.239175  9.903050  4.965503\n [29]  9.656077  8.081564  8.948798  3.708220  5.410925 12.714925  7.666618\n [36] 10.636295 11.886290 14.767056  8.670500  7.931076  5.338484  5.097557\n [43]  3.213884 11.444994  6.093762  3.192188  1.563749  8.753929  4.177170\n [50] 12.242498  5.781476 12.783701  4.418721  8.442989  4.282396  9.395394\n [57]  8.255719  6.016290  8.026494  9.180810  2.038727  5.273544  7.225220\n [64]  6.654107 12.260485 10.688362  9.773488  8.216967  5.093565  6.142304\n [71]  3.274337  8.547150  9.381826  7.061813  4.016495  7.543794  6.976389\n [78] 11.550401  5.209433  3.872522 13.043037  8.277356  3.231859  8.553664\n [85]  4.576422  2.213665 11.475262  6.469006  5.333390  5.656304  6.209727\n [92]  8.908905  6.956097  9.642321  7.188749 12.413663  6.020730  8.507994\n [99] 11.776177  3.387353\n\n#Call just RMSE with specifying missing values.\nwrap_all(resp, pred, values = \"RMSE\", na.rm = TRUE)\n\n$RMSE\n[1] 0.9661699\n\n#Call just MAE with specifying missing values.\nwrap_all(resp, pred, values = \"MAE\", na.rm = TRUE)\n\n$MAE\n[1] 0.8241201\n\n#Call both with specifying missing values.\nwrap_all(resp, pred, values = \"both\", na.rm = TRUE)\n\n$RMSE\n[1] 0.9661699\n\n$MAE\n[1] 0.8241201\n\n#Call just RMSE without specifying missing values.\nwrap_all(resp, pred, values = \"RMSE\")\n\n$RMSE\n[1] NA\n\n#Call just MAE without specifying missing values.\nwrap_all(resp, pred, values = \"MAE\")\n\n$MAE\n[1] NA\n\n#Call both without specifying missing values.\nwrap_all(resp, pred, values = \"both\")\n\n$RMSE\n[1] NA\n\n$MAE\n[1] NA\n\n#Pass it incorrect data.\n#Pass built-in data frame of iris.\nwrap_all(iris, pred)\n\n[1] \"Response or prediction vectors are not numeric.\"\n\n#Pass character vector.\nchar_vec &lt;- c(\"a\", \"b\", \"c\", \"d\")\nwrap_all(char_vec, pred)\n\n[1] \"Response or prediction vectors are not numeric.\"\n\n#Finally, check that error message prints if values is something other than \"both\", \"RMSE\", or \"MAE\".\n\nwrap_all(resp, pred, values = \"RMSE and MAE\", na.rm = TRUE)\n\n[1] \"Invalid input for values. Need both, MAE, or RMSE.\"\n\n\n\n\n\nTask 3\nNote my API key is: 53ad0f05e7ae4a3298cdbdb8d0810afb\n\nQuestion #1: Use GET() from the httr package to return information about a topic that you are interested in that has been in the news lately (store the result as an R object). I chose to look at education data.\n\nlibrary(httr)\nlibrary(jsonlite)\n\n\nAttaching package: 'jsonlite'\n\n\nThe following object is masked from 'package:purrr':\n\n    flatten\n\n#Build the URL.\nurl_api &lt;- \"https://newsapi.org/v2/everything?q=education&from=2024-06-01&sortBy=popularity&apiKey=53ad0f05e7ae4a3298cdbdb8d0810afb\"\n#Use GET() from httr package to contact the API.\nreturn_ed_data &lt;- GET(url_api)\n#Print just to check that it worked.\nreturn_ed_data\n\nResponse [https://newsapi.org/v2/everything?q=education&from=2024-06-01&sortBy=popularity&apiKey=53ad0f05e7ae4a3298cdbdb8d0810afb]\n  Date: 2024-06-21 00:36\n  Status: 200\n  Content-Type: application/json; charset=utf-8\n  Size: 83.2 kB\n\n\n\n\nQuestion #2: Parse what is returned and find your way to the data frame that has the actual article information in it (check content). Note the first column should be a list column.\n\n#Parse through data using fromJSON function from jsonlite package.\nparsed_ed_data &lt;- fromJSON(rawToChar(return_ed_data$content))\n#Convert the article information to a tibble.\ned_info &lt;- as_tibble(parsed_ed_data$articles)\n#Print out the tibble with article information. Note that the first row is removed with date of 1970 (possibly a removed article) but Dr. Post okayed to ignore for this assignment.\ned_info\n\n# A tibble: 100 × 8\n   source$id $name author title description url   urlToImage publishedAt content\n   &lt;chr&gt;     &lt;chr&gt; &lt;chr&gt;  &lt;chr&gt; &lt;chr&gt;       &lt;chr&gt; &lt;chr&gt;      &lt;chr&gt;       &lt;chr&gt;  \n 1 &lt;NA&gt;      [Rem… &lt;NA&gt;   [Rem… \"[Removed]\" http… &lt;NA&gt;       1970-01-01… \"[Remo…\n 2 &lt;NA&gt;      Yaho… Devin… Enga… \"We're gea… http… &lt;NA&gt;       2024-06-07… \"If yo…\n 3 wired     Wired Chris… Bank… \"Extreme w… http… https://m… 2024-06-17… \"Clean…\n 4 the-verge The … Tom W… Goog… \"Google is… http… https://c… 2024-06-05… \"Googl…\n 5 &lt;NA&gt;      Gizm… Lucas… Elon… \"We all kn… http… https://i… 2024-06-14… \"We al…\n 6 &lt;NA&gt;      BBC … &lt;NA&gt;   What… \"Labour ha… http… https://i… 2024-06-18… \"Sir K…\n 7 &lt;NA&gt;      BBC … &lt;NA&gt;   Anal… \"Political… http… https://i… 2024-06-05… \"Chris…\n 8 &lt;NA&gt;      BBC … &lt;NA&gt;   Who … \"Our guide… http… https://i… 2024-06-11… \"John …\n 9 &lt;NA&gt;      BBC … &lt;NA&gt;   Scot… \"John Swin… http… https://i… 2024-06-11… \"By Me…\n10 &lt;NA&gt;      BBC … &lt;NA&gt;   Full… \"Education… http… https://i… 2024-06-16… \"By Ro…\n# ℹ 90 more rows\n\n\n\n\nQuestion #3: Now write a quick function that allows the user to easily query this API. The inputs to the function should be the title/subject to search for (string), a time period to search from (string - you’ll search from that time until the present), and an API key.\n\n#Write function called api_query that takes inputs subject, time, and key.\napi_query &lt;- function(subject, time, key){\n#Store the base url before the inputs as start_url.\n  start_url &lt;- \"https://newsapi.org/v2/everything\"\n#Based on documentation provided on API, paste together formatting of initial url, and inputs for what the final url shoudl look like (seen as url_api in step 1). Use paste0 to not add spaces.\n  url &lt;- paste0(start_url, \n                \"?q=\",\n                subject,\n                \"&from=\",\n                time,\n                \"&sortBy=popularity\",\n                \"&apiKey=\",\n                key)\n#Use the GET function to contact API.\n    return_data &lt;- GET(url)\n#Parse through data using fromJSON function from jsonlite package.\n  parsed_data &lt;- fromJSON(rawToChar(return_data$content))\n#Convert the article information to a tibble.\ntibble_info &lt;- as_tibble(parsed_data$articles)\n#Return ed_info tibble.\nreturn(tibble_info)\n}\n\n#Run the function twice.\n#Query to API for education data from June 18th 2024 to present.\ned_query &lt;- api_query(\"education\", \"2024-06-18\", \"53ad0f05e7ae4a3298cdbdb8d0810afb\")\n#Print education query.\ned_query\n\n# A tibble: 100 × 8\n   source$id $name author title description url   urlToImage publishedAt content\n   &lt;chr&gt;     &lt;chr&gt; &lt;chr&gt;  &lt;chr&gt; &lt;chr&gt;       &lt;chr&gt; &lt;chr&gt;      &lt;chr&gt;       &lt;chr&gt;  \n 1 &lt;NA&gt;      BBC … &lt;NA&gt;   What… \"Labour ha… http… https://i… 2024-06-18… \"Sir K…\n 2 &lt;NA&gt;      BBC … &lt;NA&gt;   Why … \"The key e… http… https://i… 2024-06-18… \"By Ch…\n 3 &lt;NA&gt;      Andr… brady… U.S.… \"The addic… http… https://c… 2024-06-19… \"What …\n 4 &lt;NA&gt;      NPR   The A… Loui… \"The legis… http… https://n… 2024-06-19… \"BATON…\n 5 &lt;NA&gt;      NPR   Meg A… Some… \"This week… http… https://n… 2024-06-19… \"Maryl…\n 6 &lt;NA&gt;      NPR   Jasmi… Bide… \"Executive… http… https://n… 2024-06-18… \"Presi…\n 7 &lt;NA&gt;      NPR   Se Eu… Russ… \"President… http… https://n… 2024-06-19… \"SEOUL…\n 8 &lt;NA&gt;      NPR   Suzan… FEMA… \"Several g… http… https://n… 2024-06-18… \"Good …\n 9 &lt;NA&gt;      Slas… msmash 87% … \"A new Gal… http… https://a… 2024-06-18… \"In th…\n10 business… Busi… Domin… A 43… \"GPT-4 con… http… https://i… 2024-06-19… \"GPT-4…\n# ℹ 90 more rows\n\n#Query to API for election data from June 1st 2024 to present.\nelection_query &lt;- api_query(\"election\", \"2024-06-01\", \"53ad0f05e7ae4a3298cdbdb8d0810afb\")\n#Print election_query. Note that the first row is removed with date of 1970 (possibly a removed article) but Dr. Post okayed to ignore for this assignment.\nelection_query\n\n# A tibble: 100 × 8\n   source$id $name author title description url   urlToImage publishedAt content\n   &lt;chr&gt;     &lt;chr&gt; &lt;chr&gt;  &lt;chr&gt; &lt;chr&gt;       &lt;chr&gt; &lt;chr&gt;      &lt;chr&gt;       &lt;chr&gt;  \n 1 &lt;NA&gt;      [Rem… &lt;NA&gt;   [Rem… [Removed]   http… &lt;NA&gt;       1970-01-01… \"[Remo…\n 2 &lt;NA&gt;      Yaho… Karis… News… Pew Resear… http… &lt;NA&gt;       2024-06-12… \"If yo…\n 3 wired     Wired Vitto… A Fo… A vast maj… http… https://m… 2024-06-03… \"On Ma…\n 4 wired     Wired Morga… Russ… A European… http… https://m… 2024-06-07… \"With …\n 5 wired     Wired Maken… A Bi… Frank McCo… http… https://m… 2024-06-13… \"By mi…\n 6 wired     Wired Leah … AI C… Meet AI St… http… https://m… 2024-06-13… \"Victo…\n 7 &lt;NA&gt;      Gizm… Matt … Bide… President … http… https://i… 2024-06-03… \"Presi…\n 8 &lt;NA&gt;      Gizm… Kate … Thou… This story… http… https://i… 2024-06-19… \"This …\n 9 &lt;NA&gt;      BBC … &lt;NA&gt;   Part… Labour and… http… https://i… 2024-06-09… \"Labou…\n10 &lt;NA&gt;      BBC … &lt;NA&gt;   ‘I’m… Brits livi… http… https://i… 2024-06-12… \"By Ya…\n# ℹ 90 more rows"
  }
]